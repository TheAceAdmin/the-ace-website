(()=>{var F=[];async function k(){try{let r=await fetch("../assets/documents/master-data");if(!r.ok)throw new Error("Failed to fetch master data");let i=await r.text(),a=i.indexOf("<\/script>");a!==-1&&(i=i.substring(a+9).trim());let o=atob(atob(i)).split(`
`).filter(n=>n.trim()),c=0;for(let n=0;n<o.length;n++)if(o[n].includes("Sl. No")||o[n].includes("Flat No")){c=n+1;break}for(let n=c;n<o.length;n++){let e=o[n];if(!e.trim())continue;let t=[],m="",u=!1;for(let g=0;g<e.length;g++){let h=e[g];if(h==='"')u=!u;else if(h===","&&!u){let f=m.trim();f.startsWith('"')&&f.endsWith('"')&&(f=f.slice(1,-1)),t.push(f),m=""}else m+=h}let d=m.trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.slice(1,-1)),t.push(d),t.length>0&&F.push({slNo:t[0]||"",appNo:t[1]||"",flatNo:t[2]||"",handover:t[3]||"",maintenanceStart:t[4]||"",newChargeStart:t[5]||"",daysUntilMonthEnd:t[6]||"",monthsUntil0104:t[7]||"",maintenanceCharge:t[8]||"",sqFt:t[9]||"",model:t[10]||"",raw:t})}return console.log(`Loaded ${F.length} records from master data`),F}catch(r){return console.error("Error loading master data:",r),[]}}function B(r,i){let a=`${r}-${i}`.toUpperCase();return F.find(s=>{let o=(s.flatNo||"").toUpperCase();return o===a||o.includes(a)})}k().then(()=>{console.log("Master data loaded successfully")});var S=document.getElementById("block"),$=document.getElementById("doorNumber"),x=document.getElementById("flatDisplay"),D="",p="",y="";function R(){let r=S.value.trim().toUpperCase(),i=$.value.trim();if(!r||!i){x.style.display="none",D="",p="",y="";return}x.textContent=`Flat: ${r}-${i}`,x.style.display="block";let a=B(r,i);if(a){if(a.handover&&a.handover!=="No handover"&&a.handover.trim()!==""){let s=a.handover.split("/");if(s.length===3){let o=s[0].padStart(2,"0"),c=s[1].padStart(2,"0"),n=s[2].trim();n.length===2&&(n="20"+n),D=`${n}-${c}-${o}`,p=`${o}-${c}-${n}`}else D=a.handover,p=a.handover}else D="",p="";a.sqFt&&a.sqFt.trim()!==""?y=a.sqFt.replace(/,/g,"").replace(/"/g,"").trim():y=""}else D="",p="",y=""}S.addEventListener("input",R);$.addEventListener("input",R);document.getElementById("calculatorForm").addEventListener("submit",function(r){r.preventDefault();let i=S.value.trim().toUpperCase(),a=document.getElementById("doorNumber").value.trim(),s=B(i,a);if(!s){alert("Flat data not found. Please check your block and door number.");return}let o=s.daysUntilMonthEnd||"0",c=s.monthsUntil0104||"0",n=s.maintenanceCharge||"0";console.log("Raw flatData:",s),console.log("Raw days value:",o),console.log("Raw months value:",c);let e=0,t=0;if(o&&o.toString().trim()!==""){let l=o.toString().replace(/,/g,"").replace(/"/g,"").trim();e=parseInt(l,10),isNaN(e)&&(e=0)}if(c&&c.toString().trim()!==""){let l=c.toString().replace(/,/g,"").replace(/"/g,"").trim();t=parseInt(l,10),isNaN(t)&&(t=0)}let m=parseFloat(n.toString().replace(/,/g,"").replace(/"/g,"").trim())||0;console.log("Parsed daysNum:",e),console.log("Parsed monthsNum:",t);let u=document.getElementById("maintenanceDaysLabel"),d=document.getElementById("maintenanceMonthsLabel"),g=isNaN(e)||e===void 0||e===null?0:e,h=isNaN(t)||t===void 0||t===null?0:t;if(console.log("=== UPDATING LABELS ==="),console.log("Display Days:",g,"Display Months:",h),u){let l=`Maintenance for ${g} days (Rs. 4 \xD7 SqFt \xD7 Days \xD7 12/365):`;u.innerHTML=l,console.log("\u2713 Days label updated:",u.textContent)}else console.error("\u2717 maintenanceDaysLabelEl element NOT found in DOM!");if(d){let l=`Maintenance for ${h} Months (Rs. 4 \xD7 SqFt \xD7 Months):`;d.innerHTML=l,console.log("\u2713 Months label updated:",d.textContent)}else console.error("\u2717 maintenanceMonthsLabelEl element NOT found in DOM!");let f=e+t*30;function I(l){return"\u20B9"+l.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}function q(l){return l.toLocaleString("en-IN")}document.getElementById("handoverDateResult").textContent=p||"-",document.getElementById("sqftResult").textContent=y?q(parseFloat(y)):"-",document.getElementById("daysResult").textContent=f+" days",document.getElementById("monthsResult").textContent=t+" months",document.getElementById("remainingDaysResult").textContent=e+" days";let L=parseFloat(y)||0,C=0,v=0;L>0&&e>0&&t>=0&&(C=4*L*e*(12/365),v=4*L*t);let T=C+v,w=m>0?m:T;document.getElementById("maintenanceDaysResult").textContent=I(C),document.getElementById("maintenanceMonthsResult").textContent=I(v),document.getElementById("totalResult").textContent=I(w),document.getElementById("results").style.display="block",requestAnimationFrame(()=>{let l=document.querySelector("#maintenanceDaysLabel"),N=document.querySelector("#maintenanceMonthsLabel"),M=isNaN(e)||e===void 0||e===null?0:e,E=isNaN(t)||t===void 0||t===null?0:t;if(console.log("Final update - Values:",{finalDaysValue:M,finalMonthsValue:E,daysNum:e,monthsNum:t}),l){let b=`Maintenance for ${M} days (Rs. 4 \xD7 SqFt \xD7 Days \xD7 12/365):`;l.textContent=b,l.innerHTML=b.replace(String(M),`<strong>${M}</strong>`),console.log("Final update - Days label set to:",l.textContent)}else console.error("finalMaintenanceDaysLabelEl not found in final update!");if(N){let b=`Maintenance for ${E} Months (Rs. 4 \xD7 SqFt \xD7 Months):`;N.textContent=b,N.innerHTML=b.replace(String(E),`<strong>${E}</strong>`),console.log("Final update - Months label set to:",N.textContent)}else console.error("finalMaintenanceMonthsLabelEl not found in final update!")}),document.getElementById("results").scrollIntoView({behavior:"smooth",block:"nearest"})});})();
